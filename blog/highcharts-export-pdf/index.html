<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Learn how to export multiple Highcharts graphs to a PDF" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <title>Export multiple Highcharts graphs as PDF - Kunal Nagar</title>
    <meta
      property="og:image"
      content="https://kunalnagar.in/assets/img/post.png"
    />
    <meta property="og:title" content="Export multiple Highcharts graphs as PDF - Kunal Nagar" />
    <meta property="og:description" content="Learn how to export multiple Highcharts graphs to a PDF" />
    <meta property="og:url" content="https://kunalnagar.in/blog/highcharts-export-pdf/" />
    <meta property="og:type" content="article" />
    <meta name="robots" content="index, follow" />
    <link rel="preload" as="style" href="/assets/css/highlighting.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
    ></script>
  </head>
  <body>
    <main>
      <nav>
  <ul>
    <li class="brand">
      <a title="Home" href="/" class="d--flex"
        ><svg
          version="1.0"
          xmlns="http://www.w3.org/2000/svg"
          width="35px"
          height="35px"
          viewBox="0 0 412.000000 416.000000"
          preserveAspectRatio="xMidYMid meet"
        >
          <g
            transform="translate(0.000000,416.000000) scale(0.100000,-0.100000)"
            fill="#000000"
            stroke="none"
          >
            <path
              d="M0 2070 l0 -2070 2060 0 2060 0 0 2070 0 2070 -2060 0 -2060 0 0
     -2070z m1780 296 c0 -215 4 -377 9 -380 5 -4 18 5 28 18 10 13 168 184 351
     380 l333 356 90 0 c51 0 89 -4 87 -9 -1 -5 -109 -126 -239 -268 -321 -351
     -305 -332 -292 -351 5 -10 134 -181 287 -382 152 -201 276 -368 276 -372 0 -5
     -41 -8 -90 -8 l-90 0 -251 336 c-138 184 -254 334 -257 332 -4 -2 -60 -58
     -124 -124 l-118 -122 0 -211 0 -211 -85 0 -85 0 0 695 0 695 85 0 85 0 0 -374z"
            />
          </g></svg
      ></a>
    </li>
    <li><a href="/foss">Open Source</a></li>
    <li><a href="/blog">Blog</a></li>
  </ul>
  <button type="button" id="btn_color_scheme" title="Toggle Color Scheme">
    Dark
  </button>
</nav>

      <div class="page-blog-single">
        <h1>Export multiple Highcharts graphs as PDF</h1>
        <time>April 18, 2019</time>
        <article><p>Most recently, I was tasked to convert a page containing multiple graphs to a single PDF without using server-side technologies. The graphs were rendered using Highcharts and the final PDF needed to have really good quality.</p>

<p>If you want to skip to the code, there’s a fiddle at the end of the post. Knock yourself out.</p>

<h2 id="default-export">Default Export</h2>

<p>By default, Highcharts has exporting functionality built in to the hamburger menu available on the top right of every graph. Of course, you need the <a href="https://www.highcharts.com/docs/export-module/export-module-overview">exporting module</a> to be included for that to show up.</p>

<!-- prettier-ignore -->
<p><a href="https://i.imgur.com/D8hmB7I.png" aria-label="" data-lightbox="https://i.imgur.com/D8hmB7I.png" class="lightbox-img">
  <img src="https://i.imgur.com/D8hmB7I.png" alt="" />
</a></p>

<p>While it works pretty well out of the box, the problem is that you can only download one graph at a time. What if you need to add multiple graphs (like a dashboard) to a PDF?</p>

<h2 id="setup">Setup</h2>

<p>You’ll need the following libraries:</p>

<ul>
  <li>Highcharts - Core</li>
  <li>Highcharts - Exporting Plugin</li>
  <li>Highcharts - Offline Exporting Plugin</li>
  <li>jsPDF</li>
</ul>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.highcharts.com/highcharts.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.highcharts.com/modules/exporting.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.highcharts.com/modules/offline-exporting.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></figure>

<p><strong>Note:</strong> If you want offline exporting and don’t want to send graph data to Highsoft’s servers (for privacy reasons), yo need to add the following option to the Highcharts graph options:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">exporting</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">enabled</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">fallbackToExportServer</span><span class="p">:</span> <span class="kc">false</span>
<span class="p">}</span></code></pre></figure>

<h2 id="adding-graphs-to-pdf">Adding graphs to PDF</h2>

<p>The way this works is that we need to export the Highcharts graph as an image and then slap it on the PDF. After a lot of testing, I’ve come to a conclusion that exporting a chart as SVG on the PDF gives best results and quality.</p>

<p>In this example, we’ll be using two charts - one scatter and one pie chart. Let’s assume that their respective Highchart objects are <code class="language-plaintext highlighter-rouge">chart1</code> and <code class="language-plaintext highlighter-rouge">chart2</code></p>

<p>We will also need an instance of jsPDF:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">pdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">jsPDF</span><span class="p">(</span><span class="dl">'</span><span class="s1">p</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">mm</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1400</span><span class="p">]);</span></code></pre></figure>

<p>If you look at the Highcharts API, it has a method called <a href="https://api.highcharts.com/class-reference/Highcharts.Chart#exportChartLocal"><code class="language-plaintext highlighter-rouge">exportChartLocal</code></a> that allows you to export a chart in a specific format (JPEG, PNG, SVG and PDF). The problem is that calling the method triggers a download popup in the browser. We don’t really want that - instead we want the <code class="language-plaintext highlighter-rouge">dataURL</code> (a base64 encoded string) of the image that we can put on the PDF using <a href="http://raw.githack.com/MrRio/jsPDF/master/docs/module-addImage.html"><code class="language-plaintext highlighter-rouge">addImage</code></a>.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">chart1</span><span class="p">.</span><span class="nx">exportChartLocal</span><span class="p">(</span><span class="dl">'</span><span class="s1">image/svg+xml</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">chart2</span><span class="p">.</span><span class="nx">exportChartLocal</span><span class="p">(</span><span class="dl">'</span><span class="s1">image/svg+xml</span><span class="dl">'</span><span class="p">);</span></code></pre></figure>

<p>To stop the download popup and get the <code class="language-plaintext highlighter-rouge">dataURL</code>, we need to hook into the <code class="language-plaintext highlighter-rouge">downloadURL</code> method on the base Highcharts object that will give us the <code class="language-plaintext highlighter-rouge">dataURL</code> and the <code class="language-plaintext highlighter-rouge">filename</code> of the image.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">Highcharts</span><span class="p">.</span><span class="nx">downloadURL</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dataURL</span><span class="p">,</span> <span class="nx">filename</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">pdf</span><span class="p">.</span><span class="nx">addImage</span><span class="p">(</span><span class="nx">dataURL</span><span class="p">,</span> <span class="dl">'</span><span class="s1">SVG</span><span class="dl">'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="p">};</span></code></pre></figure>

<p>Yet another problem here is that there is no callback to the <code class="language-plaintext highlighter-rouge">exportChartLocal</code> method so we’ll have to use a counter and an array to store the dataURLs in an array.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">imageURLs</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nx">Highcharts</span><span class="p">.</span><span class="nx">downloadURL</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dataURL</span><span class="p">,</span> <span class="nx">filename</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">imageURLs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">dataURL</span><span class="p">);</span>
  <span class="nx">counter</span><span class="o">++</span><span class="p">;</span>
<span class="p">};</span></code></pre></figure>

<p>To check if all the dataURLs are added to the array, we need to poll continuously. Once the array is prepared, we loop over it and add the image URLs to the PDF:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">interval</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">counter</span> <span class="o">===</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">interval</span><span class="p">);</span>
    <span class="nx">imageURLs</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">img</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">pdf</span><span class="p">.</span><span class="nx">addImage</span><span class="p">(</span><span class="nx">img</span><span class="p">,</span> <span class="dl">'</span><span class="s1">SVG</span><span class="dl">'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
      <span class="nx">pdf</span><span class="p">.</span><span class="nx">addPage</span><span class="p">();</span>
    <span class="p">});</span>
    <span class="nx">pdf</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="dl">'</span><span class="s1">test.pdf</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="mi">100</span><span class="p">);</span></code></pre></figure>

<p>And it’s done! Here’s a demo of the entire process. Switch to the <strong>Result</strong> tab and click on the <strong>Export</strong> button to download the PDF. The code contains comments so it’s easy to follow.</p>

<iframe width="100%" height="500" src="//jsfiddle.net/kunalnagar/aku06o24/53/embedded/js,html,result/" allowfullscreen="allowfullscreen" allowpaymentrequest="" frameborder="0"></iframe>
</article>
      </div>
    </main>
    <footer>
  <div class="cookie-monster--shell">
    <div class="cookie-monster--notice">
      <h4>OM NOM NOM</h4>
      <p>This site gots cookies 🍪</p>
      <button type="button" class="cookie-monster--notice--button">
        Oh-kay.
      </button>
    </div>
    <button type="button" class="cookie-monster--button" title="Boop me.">
      <img
        src="/assets/img/cookie-monster.png"
        alt="Cookie Monster"
        class="cookie-monster--img"
      />
    </button>
  </div>
  <script src="/assets/js/main-bundle.js"></script>
</footer>

    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/css/lightbox.min.css"
    />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox.min.js"
      async
      defer
    ></script>
  </body>
</html>
