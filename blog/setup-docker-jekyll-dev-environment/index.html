<!DOCTYPE html>
<html lang="en" class="light">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Learn how to setup a Jekyll development environment using Docker" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <title>Setup a Jekyll development environment with Docker - Kunal Nagar</title>
    <meta
      property="og:image"
      content="https://kunalnagar.in/assets/img/post.png"
    />
    <meta property="og:title" content="Setup a Jekyll development environment with Docker - Kunal Nagar" />
    <meta property="og:description" content="Learn how to setup a Jekyll development environment using Docker" />
    <meta property="og:url" content="https://kunalnagar.in/blog/setup-docker-jekyll-dev-environment/" />
    <meta property="og:type" content="article" />
    <meta name="robots" content="index, follow" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap"
  rel="stylesheet"
/>

    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
  </head>
  <body>
    <main>
      <nav>
  <ul>
    <li><a href="/">Kunal Nagar</a></li>
    <li><a href="/foss">Open Source</a></li>
    <li><a href="/blog">Blog</a></li>
  </ul>
</nav>

      <div class="page-blog-single">
        <section class="section">
          <h1>Setup a Jekyll development environment with Docker</h1>
          <time class="muted">December 14, 2019</time>
        </section>
        <article><p>Most recently, I’ve been converting all my development environments to Docker. The primary reason for doing this stemmed from the frustration of installing multiple dependencies on my Mac and trying to keep them up-to-date.</p>

<p>This guide assumes that you have a basic knowledge of Jekyll, Docker and are comfortable working with the Terminal. If not, I would highly recommend that you keep reading as I try to provide documentation links when possible.</p>

<h3 id="requirements">Requirements</h3>

<p>Here are a few requirements to follow along:</p>

<ul>
  <li><a href="https://github.com/kunalnagar/kunalnagar.in">Jekyll site</a></li>
  <li><a href="https://docs.docker.com/v17.09/engine/installation/">Install Docker</a> on your development machine</li>
  <li><a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)">Bash/ZSH Terminal</a></li>
</ul>

<h3 id="step-1">Step 1</h3>

<p>Let’s start off with the fact that you have the code for a Jekyll site on your computer. It could be yours or anyone else’s for that matter.</p>

<p><img src="https://i.imgur.com/oiKnu70.png" alt="Screenshot showing cloned repository in VSCode" /></p>

<p>With Docker, we can setup a development environment to run this Jekyll site so we don’t have to install unnecessary dependencies on our computer.</p>

<h3 id="step-2">Step 2</h3>

<p>It’s time to set up our <code class="language-plaintext highlighter-rouge">Dockerfile</code> and <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> files. The <code class="language-plaintext highlighter-rouge">Dockerfile</code> will setup our development environment from scratch and the <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> will make sure that our NPM dependencies are installed, the development server is started up and we can get to work.</p>

<p>Here is the <code class="language-plaintext highlighter-rouge">Dockerfile</code> and here’s what it does:</p>

<ul>
  <li>Base Operating System - Ubuntu 18.04 LTS</li>
  <li>Default Terminal - Bash</li>
  <li>Update the system and make it ready for installing dependencies</li>
  <li>Install Jekyll dependencies</li>
  <li>Configure Ruby and make <code class="language-plaintext highlighter-rouge">gem</code> available from the command line</li>
  <li>Install Jekyll and Bundler</li>
</ul>

<p>Here are some optional steps. I have Node and NPM setup to run the development server and create a build if needed:</p>

<ul>
  <li>Install Node and NPM</li>
  <li>Expose port 4000 (since Jekyll runs on that port)</li>
</ul>

<figure class="highlight"><pre><code class="language-docker" data-lang="docker"><span class="k">FROM</span><span class="s"> ubuntu:18.04</span>

<span class="k">SHELL</span><span class="s"> ["/bin/bash", "-c"]</span>

<span class="k">RUN </span>apt-get update <span class="o">&amp;&amp;</span> apt-get upgrade <span class="nt">-y</span>

<span class="k">RUN </span>apt-get <span class="nb">install </span>curl ruby-full build-essential zlib1g-dev <span class="nt">-y</span>

<span class="k">RUN </span><span class="nb">echo</span> <span class="s1">'# Install Ruby Gems to ~/gems'</span> <span class="o">&gt;&gt;</span> ~/.bashrc <span class="o">&amp;&amp;</span> <span class="se">\
</span> <span class="nb">echo</span> <span class="s1">'export GEM_HOME="$HOME/gems"'</span> <span class="o">&gt;&gt;</span> ~/.bashrc <span class="o">&amp;&amp;</span> <span class="se">\
</span>  <span class="nb">echo</span> <span class="s1">'export PATH="$HOME/gems/bin:\$PATH"'</span> <span class="o">&gt;&gt;</span> ~/.bashrc <span class="o">&amp;&amp;</span> <span class="se">\
</span> <span class="nb">source</span> ~/.bashrc

<span class="k">RUN </span>gem <span class="nb">install </span>jekyll bundler <span class="o">&amp;&amp;</span> gem update <span class="nt">--system</span>

<span class="c"># Optional (Installing Node and NPM)</span>

<span class="k">RUN </span>curl <span class="nt">-sSL</span> <span class="s2">"https://nodejs.org/dist/v12.13.1/node-v12.13.1-linux-x64.tar.xz"</span> | <span class="nb">tar</span> <span class="nt">--strip-components</span><span class="o">=</span>2 <span class="nt">-xJ</span> <span class="nt">-C</span> /usr/local/bin/ node-v12.13.1-linux-x64/bin/node <span class="o">&amp;&amp;</span> <span class="se">\
</span> curl https://www.npmjs.com/install.sh | bash

<span class="k">EXPOSE</span><span class="s"> 4000</span></code></pre></figure>

<p>With the file above, a working Jekyll environment should be setup. Now, we want to map our Jekyll Site to this working environment and start the server. This is where the <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> comes in. Here are the steps in brief:</p>

<ul>
  <li>Setup an <code class="language-plaintext highlighter-rouge">app</code> container</li>
  <li>Map the Jekyll site on your computer using the <code class="language-plaintext highlighter-rouge">volumes</code> key</li>
  <li>Map the port on your local machine to the Docker container (port <code class="language-plaintext highlighter-rouge">4000</code>)</li>
  <li>Start the development server</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.6'</span>
<span class="na">services</span><span class="pi">:</span>

  <span class="na">app</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">docker_kunalnagar.in</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">.</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">.:/var/www/html</span>
    <span class="na">working_dir</span><span class="pi">:</span> <span class="s">/var/www/html</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">4000:4000</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
    <span class="na">command</span><span class="pi">:</span> <span class="pi">&gt;</span>
      <span class="s">sh -c "bundle install &amp;&amp;</span>
            <span class="s">npm install &amp;&amp;</span>
            <span class="s">npm run dev"</span></code></pre></figure>

<h3 id="step-3">Step 3</h3>

<p>All you need to do is run <code class="language-plaintext highlighter-rouge">docker-compose up -d</code> and you’re ready to start working on your Jekyll site at <code class="language-plaintext highlighter-rouge">http://localhost:4000</code></p>

<h3 id="notes">Notes</h3>

<p>If you run into issues, you can use the following commands to inspect your container:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="c"># See a LIVE view of your Docker container's logs</span>
docker logs <span class="nt">-f</span> &lt;container_name&gt;

<span class="c"># Login to your Docker container and browser around</span>
docker <span class="nb">exec</span> <span class="nt">-ti</span> &lt;container_name&gt; bash</code></pre></figure>

<p>The code for this website is hosted <a href="https://github.com/kunalnagar/kunalnagar.in">here</a> if you want to take a look at the big picture and how it all comes together.</p>

<h3 id="next-steps">Next steps</h3>

<p>Currently, this site is built on <a href="https://travis-ci.com/kunalnagar/kunalnagar.in">Travis</a> with a different configuration than what I have on Docker. Now that I have a development environment set up, I’d like to deploy the same using Travis.</p>
</article>
      </div>
    </main>
    
  </body>
</html>
